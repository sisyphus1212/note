kernel/irq/irqdesc.c: early_trap_init
arch/arm/kernel/irq.c: init_IRQ

```c
int __init early_irq_init(void)
{
    int count, i, node = first_online_node;
    struct irq_desc *desc;

    /* 初始化 irq_default_affinity 变量, 此变量用于设置中断默认的 CPU 亲和力 */
    init_irq_default_affinity();

    printk(KERN_INFO "NR_IRQS:%d\n", NR_IRQS);

    /* 指向中断描述符数组 irq_desc */
    desc = irq_desc;
    /* 获取中断描述符数组长度 */
    count = ARRAY_SIZE(irq_desc);

    for (i = 0; i < count; i++) {
        /* 为 kstat_irqs 分配内存, 每个 CPU 有自己独有的 kstat_irqs 数据, 此数据用于统计 */
        desc[i].kstat_irqs = alloc_percpu(unsigned int);
        /* 为 desc->irq_data.affinity 和 desc->pending_mask 分配内存 */
        alloc_masks(&desc[i], GFP_KERNEL, node);
        /* 初始化中断描述符的锁 */
        raw_spin_lock_init(&desc[i].lock);
        /* 设置中断描述符的锁所属的类, 此类用于防止死锁 */
        lockdep_set_class(&desc[i].lock, &irq_desc_lock_class);
        /* 一些变量的初始化 */
        desc_set_defaults(i, &desc[i], node, NULL);
    }

    return arch_early_irq_init();
}
```